CALCULATIONS AND FUNCTION CALLS

This project uses a SQLite database to store artworks from four museum APIs.
After the database is populated, we run several calculation functions to
summarize the data and generate visualizations.

All of the calculations start from the function main_visualizations(conn),
which is called inside main() after the database connection is created.

1. Loading the data

Function: load_artworks_raw(conn)

- Runs a SQL SELECT that joins the artworks table with museum, classifications,
  cultures, artists, and dates.
- Returns a list of tuples, where each tuple looks like:
  (museum_name, classification_text, culture_text, artist_name, date_text)
- This list (called rows) is the input to all later calculation functions.

2. Normalizing text

Function: normalize(text)

- Cleans up text values so they are consistent.
- If the value is None or empty, it returns "Unknown".
- Otherwise, it strips whitespace and converts the text to Title Case.
- This helps keep categories like "american", "American", and " AMERICAN "
  all grouped together.

3. Culture distribution per museum

Function: calculate_culture_distribution(rows, top_n=8)

- For each row, it looks at the museum name and culture.
- It counts how many artworks belong to each culture for each museum.
- The result is a nested dictionary like:
  {
    "Art Institute Of Chicago": [("American", 5), ("French", 3), ...],
    "Metropolitan Museum Of Art": [("Italian", 4), ("Unknown", 2), ...],
    ...
  }
- Only the top N cultures (default 8) are kept per museum.
- This output is used by plot_culture_pies() to make pie charts.

4. Top artists across all museums

Function: calculate_top_artists(rows, top_n=8)

- Looks at the artist field in each row.
- Counts how many artworks each artist has in the dataset.
- Returns a sorted list of (artist_name, count) for the top N artists.
  Example: [("Claude Monet", 3), ("Unknown Artist", 2), ...]
- This output is used by plot_top_artists() to create a bar chart.

5. Top classifications across all museums

Function: calculate_top_classifications(rows, top_n=8)

- Looks at the classification field in each row (e.g., Painting, Sculpture).
- Counts how many artworks fall into each classification.
- Returns a sorted list of (classification, count) for the top N.
- This output is used by plot_top_classifications() to create a bar chart.

6. Century distribution per museum

Function: calculate_century_distribution(rows)

- Looks at the date_text field for each artwork.
- Uses a regular expression to find a 4-digit year inside the text.
- Converts that year into a century label like "19th c.".
- If no year can be found, it labels the artwork as "Unknown".
- Counts how many artworks from each century exist for each museum.
- Returns a nested dictionary:
  {
    "Metropolitan Museum Of Art": {"19th c.": 3, "20th c.": 2, "Unknown": 1},
    ...
  }
- This output is used by plot_century_stacked_bar() to create a stacked bar chart.

7. Visualizations

The following functions take the calculated metrics and make plots:

- plot_culture_pies(culture_data)
  - Creates a pie chart for each museum showing the cultural origins of its artworks.
  - Saves each figure as "culturepie_<Museum_Name>.png".

- plot_top_artists(top_artists)
  - Creates a horizontal bar chart of the top artists across all museums.
  - Saves the figure as "top_artists.png".

- plot_top_classifications(top_classes)
  - Creates a horizontal bar chart of the top classifications.
  - Saves the figure as "top_classifications.png".

- plot_century_stacked_bar(century_data)
  - Creates a stacked bar chart with centuries on the x-axis and counts on the y-axis.
  - Each stacked segment represents a different museum.
  - Saves the figure as "century_stacked.png".

8. Writing metrics to a text file

Function: write_metrics_to_txt(culture_data, top_artists, top_classes, filename="art_metrics.txt")

- Writes a summary of the key metrics into a text file.
- The file includes:
  - Top cultures per museum
  - Top artists across all museums
  - Top classifications across all museums
- The default output file name is "art_metrics.txt".

9. How everything is called

Function: main_visualizations(conn)

- Orchestrates all of the above steps in this order:

  rows = load_artworks_raw(conn)

  culture_data = calculate_culture_distribution(rows)
  top_artists = calculate_top_artists(rows)
  top_classes = calculate_top_classifications(rows)
  century_stacked = calculate_century_distribution(rows)

  plot_culture_pies(culture_data)
  plot_top_artists(top_artists)
  plot_top_classifications(top_classes)
  plot_century_stacked_bar(century_stacked)

  write_metrics_to_txt(culture_data, top_artists, top_classes)

- This function is called inside main(), after we connect to the database.
